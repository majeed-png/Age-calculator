<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>حاسبة العمر – تفاصيل عمرك | عبدالمجيد الثويني</title>
<meta name="description" content="تفاصيل دقيقة لعُمرك بالعربي: سنوات وشهور وأسابيع وأيام وساعات، مع معلومات اليوم والفصل ووقت عيد ميلادك القادم وحقائق ممتعة.">
<meta name="keywords" content="تفاصيل العمر, عمر بالاشهر, عمر بالايام, حساب العمر بالهجري, حساب العمر بالميلادي, متى عيد ميلادي, كم باقي على عيد ميلادي, احسب عمري, حاسبة العمر, أم القرى">
<meta property="og:title" content="تفاصيل عمرك">
<meta property="og:description" content="تفاصيل دقيقة لعُمرك بالعربي + حقائق ممتعة.">
<style>
:root{
  --bg:#0f1115;
  --card:#151a22;
  --text:#e9eef6;
  --muted:#a8b3c7;
  --accent:#ef4444;
  --accent-2:#ef4444;
  --radius:14px;
  --shadow: 0 10px 30px rgba(0,0,0,.25);
  --font: "Tajawal", system-ui, -apple-system, "Segoe UI", Roboto, "Noto Kufi Arabic", "Noto Sans Arabic", Arial, "Apple Color Emoji","Segoe UI Emoji";
}
:root[data-theme='light']{
  --bg:#e7ecf3;
  --card:#f1f4f9;
  --text:#0b0f14;
  --muted:#4b5565;
}
:root[data-theme='amoled']{
  --bg:#000000;
  --card:#0a0a0a;
  --text:#e9eef6;
  --muted:#a8b3c7;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:
     radial-gradient(1200px 600px at 100% -10%, rgba(124,92,255,.10), transparent 60%),
     radial-gradient(1200px 600px at -30% 110%, rgba(46,211,198,.08), transparent 60%),
     var(--bg);
  color:var(--text);
  font-family:var(--font);
  line-height:1.7;
}
:root[data-theme='light'] body,
:root[data-theme='light']{
  background:
     radial-gradient(1200px 600px at 100% -10%, rgba(124,92,255,.06), transparent 60%),
     radial-gradient(1200px 600px at -30% 110%, rgba(46,211,198,.06), transparent 60%),
     var(--bg);
}
.container{max-width:1000px;margin:24px auto;padding:16px}
.card{
  background:var(--card);
  border:1px solid rgba(255,255,255,.06);
  border-radius: var(--radius);
  padding:18px;
  box-shadow: var(--shadow);
  margin-top:16px;
}
:root[data-theme='light'] .card{border:1px solid rgba(10,10,10,.08)}
h1{margin:0 0 8px 0;font-weight:800;letter-spacing:.2px}
h2{margin:22px 0 10px 0;font-weight:800}
h3{margin:14px 0 10px 0;font-weight:800}
a{color:var(--accent)}
label{display:block;font-weight:700;margin-bottom:6px}

input, select{
  width:100%;
  border-radius:12px;
  padding:12px 14px;
  height:52px;
  background:#0c0f14;
  color:var(--text);
  border:1px solid rgba(255,255,255,.08);
  outline:none;
  transition: box-shadow .2s, border-color .2s;
}
:root[data-theme='light'] input,
:root[data-theme='light'] select{
  background:#e9edf4;
  border:1px solid rgba(0,0,0,.10);
  color:#0b0f14;
}
input:focus, select:focus{
  box-shadow:0 0 0 3px color-mix(in oklab, var(--accent) 38%, transparent);
  border-color: var(--accent);
}

/* Accent buttons stay accent in all themes */
button{
  cursor:pointer;
  border:none;
  border-radius:12px;
  padding:12px 14px;
  height:52px;
  background:linear-gradient(135deg, var(--accent), var(--accent-2));
  color:white;
  font-weight:800;
}

/* Ghost button (copy link) adapts to theme */
.ghost-btn{
  background:#0c0f14;
  color:var(--text);
  border:1px solid rgba(255,255,255,.15);
}
:root[data-theme='light'] .ghost-btn{
  background:#eef3fa;
  color:#0b0f14;
  border:1px solid rgba(0,0,0,.12);
}

.muted{color:var(--muted)}
.notice{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:14px;margin-top:10px}
:root[data-theme='light'] .notice{background:#eef3fa;border:1px dashed rgba(0,0,0,.12)}
.navbar{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:8px}
.navbar .row{display:flex;gap:10px;flex-wrap:nowrap}
.badge{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.06);font-weight:700}
.inputs{display:grid;grid-template-columns:1fr 1fr;gap:12px;align-items:end}
@media(max-width:800px){.inputs{grid-template-columns:1fr}}
.kpis{display:grid;grid-template-columns:repeat(5,1fr);gap:12px}
@media(max-width:900px){.kpis{grid-template-columns:repeat(2,1fr)}}
.kpi{background:#0c0f14;border:1px solid rgba(255,255,255,.06);border-radius:12px;padding:14px}
:root[data-theme='light'] .kpi{background:#e9edf4;border:1px solid rgba(0,0,0,.08)}
.kpi .num{font-size:1.6rem;font-weight:900}
.tag{padding:6px 10px;border-radius:12px;background:rgba(255,255,255,.08);font-weight:700}
:root[data-theme='light'] .tag{background:#e9edf4}
footer{opacity:.7;padding:20px 6px}
.panel{display:none;margin-top:10px}
.row{display:flex;gap:10px;flex-wrap:wrap}
.theme-btn{padding:12px 14px;border-radius:12px;background:#0c0f14;border:1px solid rgba(255,255,255,.14);cursor:pointer;color:var(--text)!important;min-width:140px;text-align:center;position:relative}
:root[data-theme='light'] .theme-btn{background:#e9edf4;border:1px solid rgba(0,0,0,.12);color:#0b0f14!important}
.theme-btn.selected{outline:3px solid var(--accent); outline-offset:3px; border-color:var(--accent)}
.color-dot{width:26px;height:26px;border-radius:50%;border:2px solid rgba(255,255,255,.5);cursor:pointer;position:relative}
:root[data-theme='light'] .color-dot{border-color:rgba(0,0,0,.35)}
.color-dot.selected::after{content:"✓"; position:absolute; inset:0; display:flex; align-items:center; justify-content:center;font-weight:900; color:#000; mix-blend-mode:screen}
.small-btn{min-width:56px}
.select-wrap{position:relative}
.select-wrap select{appearance:none;-webkit-appearance:none;padding-inline-start:14px;padding-inline-end:40px}
.select-wrap .caret{position:absolute; left:12px; top:50%; transform:translateY(-50%); pointer-events:none; opacity:.7}
.lang-chip{padding:8px 12px;border-radius:12px;background:#0c0f14;border:1px solid rgba(255,255,255,.14);cursor:pointer;opacity:.55}
:root[data-theme='light'] .lang-chip{background:#e9edf4;border:1px solid rgba(0,0,0,.12)}
.lang-chip.selected{outline:3px solid var(--accent); outline-offset:3px; opacity:1}
.share-row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
.share-btn{max-width:260px}
:root[data-theme='light'] .birthday-banner{ color:#0b0f14 !important; text-shadow:none !important; }
.copy-toast{position:fixed;bottom:22px;right:22px;background:var(--card);border:1px solid rgba(255,255,255,.14);padding:10px 14px;border-radius:12px;display:none}
.countdown{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:center;margin-top:10px}
.count-box{min-width:110px;text-align:center;background:#0c0f14;border:1px solid rgba(255,255,255,.08);padding:10px 12px;border-radius:12px}
:root[data-theme='light'] .count-box{background:#e9edf4;border:1px solid rgba(0,0,0,.08)}
.count-num{font-weight:900;font-size:1.5rem}
.fact-line{margin:14px 0; font-weight:800} /* thicker facts text on page */
.ver{opacity:.6;font-weight:700}
.facts-title{font-weight:900; letter-spacing:.1px}

.bento{display:grid;grid-template-columns:1.2fr 1fr;gap:16px}
@media(max-width:1100px){.bento{grid-template-columns:1fr}}
.birthday .card, .birthday body{ 
  background: radial-gradient(1000px 600px at 0% 0%, rgba(255,215,0,.12), transparent 60%), 
              radial-gradient(1000px 600px at 100% 100%, rgba(255,105,180,.12), transparent 60%), var(--bg);
}
.birthday-banner{ display:none; background:linear-gradient(135deg, #ffd700, #ff69b4); color:#ffffff; border:0; text-align:center; padding:18px; border-radius:16px; font-weight:900; font-size:1.4rem; box-shadow:0 10px 40px rgba(0,0,0,.35), inset 0 0 60px rgba(255,255,255,.5); }
.birthday .birthday-banner{ display:block; }
:root[data-theme='light'] .birthday-banner{ color:#0b0f14 !important; text-shadow:none !important; }
.copy-toast{position:fixed;bottom:22px;right:22px;background:var(--card);border:1px solid rgba(255,255,255,.14);padding:10px 14px;border-radius:12px;display:none}
.fact-line{margin:14px 0; font-weight:800}
</style>

<link rel="icon" type="image/png" href="favicon.png">
</head>
<body dir="rtl" lang="ar">
<div class="container">
  <div class="navbar">
    <div class="badge" data-i18n="details_badge">تفاصيل عمرك</div>
    <div class="row">
      <button id="openCustomize" style="max-width:140px" data-i18n="settings">الإعدادات</button>
      <a href="index.html" title="رجوع"><button class="small-btn" style="background:#0c0f14;border:1px solid rgba(255,255,255,.15)">⬅️</button></a>
    </div>
  </div>

  
<div id="customizePanel" class="panel card" style="margin-top:8px">
  <h3 data-i18n="settings_title">الإعدادات</h3>
  <h4 data-i18n="background">الخلفية</h4>
  <div class="row">
    <div class="theme-btn" data-theme="light" data-i18n="theme_light">فاتح</div>
    <div class="theme-btn" data-theme="dark" data-i18n="theme_dark">داكن</div>
    <div class="theme-btn" data-theme="amoled" data-i18n="theme_amoled">أسود خالص (AMOLED)</div>
  </div>
  <hr/>
  <h4 data-i18n="button_color">لون الأزرار</h4>
  <div class="row" id="accentRow">
    <div class="color-dot" data-accent="#6d62ff" style="background:#6d62ff"></div>
    <div class="color-dot" data-accent="#2ed3c6" style="background:#2ed3c6"></div>
    <div class="color-dot" data-accent="#f97316" style="background:#f97316"></div>
    <div class="color-dot" data-accent="#22c55e" style="background:#22c55e"></div>
    <div class="color-dot" data-accent="#06b6d4" style="background:#06b6d4"></div>
    <div class="color-dot" data-accent="#ef4444" style="background:#ef4444"></div>
  </div>
  <hr/>
  <h4 data-i18n="language">اللغة</h4>
  <div class="row">
    <div class="lang-chip" data-lang="ar">العربية</div>
    <div class="lang-chip" data-lang="en">English</div>
  </div>
  <hr/>
  <h4 data-i18n="timezone">المنطقة الزمنية</h4>
  <div class="row">
    <select id="tzSelect" style="max-width:420px"></select>
  </div>
  <div class="muted" style="margin-top:8px" data-i18n="settings_hint">الخلفية لا تغيّر ألوان الأزرار — اختر اللون أعلاه. يتم حفظ الإعدادات تلقائيًا.</div>
</div>


  <div class="card birthday-banner" data-i18n="birthday_today">اليوم عيد ميلادك! كل عام وأنت بخير 🎉</div>

  <div id="contentArea" class="bento" style="display:none">
    <div class="card">
      <h2 data-i18n="metrics_title">عمرك بصيغ وأشكال مختلفة</h2>
      <div class="kpis">
        <div class="kpi"><div class="muted" data-i18n="years">بالسنوات</div><div class="num" id="yearsAge">—</div></div>
        <div class="kpi"><div class="muted" data-i18n="months">بالأشهر</div><div class="num" id="monthsAge">—</div></div>
        <div class="kpi"><div class="muted" data-i18n="weeks">بالأسابيع</div><div class="num" id="weeksAge">—</div></div>
        <div class="kpi"><div class="muted" data-i18n="days">بالأيام</div><div class="num" id="daysAge">—</div></div>
        <div class="kpi"><div class="muted" data-i18n="hours">بالساعات</div><div class="num" id="hoursAge">—</div></div>
      </div>

      <div class="notice" style="margin-top:12px">
        <b data-i18n="countdown_title">العد التنازلي لعيد ميلادك القادم</b>
        <div id="countdown" class="countdown" style="margin-top:8px">
          <div class="count-box"><div class="count-num" id="cdDays">—</div><div class="muted" data-i18n="cd_days">أيام</div></div>
          <div class="count-box"><div class="count-num" id="cdHours">—</div><div class="muted" data-i18n="cd_hours">ساعات</div></div>
          <div class="count-box"><div class="count-num" id="cdMin">—</div><div class="muted" data-i18n="cd_minutes">دقائق</div></div>
          <div class="count-box"><div class="count-num" id="cdSec">—</div><div class="muted" data-i18n="cd_seconds">ثواني</div></div>
        </div>
      </div>

      <div class="share-row">
        <button id="shareBtn" class="share-btn" data-i18n="share_image">مشاركة كصورة (طولي)</button>
        <button id="shareSquareBtn" class="share-btn" data-i18n="share_square">مشاركة إنستا (مربّع)</button>
        <button id="copyLinkBtn" class="ghost-btn share-btn" class="ghost-btn share-btn" data-i18n="copy_link">نسخ الرابط</button>
      </div>
      <div class="copy-toast"></div>
      <hr/>
      <h3 data-i18n="more_info">معلومات أكثر عن عمرك</h3>
      <div class="row">
        <span class="tag"><span data-i18n="born_day">ولدت يوم: </span><b id="weekday">—</b></span>
        <span class="tag"><span data-i18n="born_season">ولدت في فصل: </span><b id="season">—</b></span>
        <span class="tag"><span data-i18n="life_stage">مرحلة حياتك: </span><b id="lifeStage">—</b></span>
        <span class="tag" id="sleepTag">—</span>
        </div>
        <div id="sleepHint" class="hint" style="display:none"></div>

        <hr/>
      <h3 data-i18n="greg_age">العمر بالميلادي</h3>
      <div id="gregInfo" class="muted">—</div>
      <hr/>
      <h3 data-i18n="hijri_age">العمر بالهجري (أم القرى)</h3>
      <div id="hijriInfo" class="muted">—</div>
    </div>

    <div class="card">
      <h2 class="facts-title" data-i18n="facts">حقائق حصلت في حياتك</h2>
      <div id="breathsLine" class="fact-line">—</div>
      <div id="heartbeatsLine" class="fact-line">—</div>
      <div id="laughsLine" class="fact-line">—</div>
      <div id="sleptLine" class="fact-line">—</div>
      <div id="eatenLine" class="fact-line">—</div>
      <div class="notice" data-i18n="clarify">
        معدلات تقريبية ثابتة: ٢٠ ألف نَفَس/يوم، ٨٠ نبضة/دقيقة، ١٠ ضحكات/يوم، ٨ ساعات نوم/يوم، ٨٠ دقيقة طعام/يوم.
      </div>
    </div>
  </div>

  <div class="card notice" id="noData" style="display:none">
    <span data-i18n="no_birth">لم يتم إدخال تاريخ ميلاد بعد.</span>
    <a href="index.html" data-i18n="go_input">اذهب لصفحة الإدخال</a>.
  </div>

  <footer class="container">
    صُنِع لـ <b>عبدالمجيد الثويني</b> · <span class="ver">v9.8g</span> · يعمل دون إنترنت · © <span id="yearNow"></span>
  </footer>
</div>

<script>
const TEXTS = {
  ar:{details_badge:"🎯 تفاصيل عمرك",settings:"الإعدادات",btn_color:"لون الأزرار",
       metrics_title:"عمرك بصيغ وأشكال مختلفة",years:"بالسنوات",months:"بالأشهر",weeks:"بالأسابيع",days:"بالأيام",hours:"بالساعات",
       share_image:"مشاركة كصورة (طولي)",share_square:"مشاركة إنستا (مربّع)",copy_link:"نسخ الرابط",
       more_info:"معلومات أكثر عن عمرك",born_day:"ولدت يوم: ",born_season:"ولدت في فصل: ",life_stage:"مرحلة حياتك: ",
       greg_age:"العمر بالميلادي",hijri_age:"العمر بالهجري (أم القرى)",
       facts:"حقائق حصلت في حياتك",clarify:"Approximate averages: 20k breaths/day, 80 bpm, 10 laughs/day, 8 h sleep/day, 80 min eating/day.",
       timezone:"المنطقة الزمنية",cd_days:"أيام",cd_hours:"ساعات",cd_minutes:"دقائق",cd_seconds:"ثواني",
       countdown_title:"العد التنازلي لعيد ميلادك القادم",birthday_today:"اليوم عيد ميلادك! كل عام وأنت بخير 🎉"},
  en:{details_badge:"🎯 Your Age Details",settings:"Settings",btn_color:"Button Color",
       metrics_title:"Your Age in Many Ways",years:"Years",months:"Months",weeks:"Weeks",days:"Days",hours:"Hours",
       share_image:"Share as Image (Portrait)",share_square:"Share as Image (Square)",copy_link:"Copy link",
       more_info:"More about your age",born_day:"Born on: ",born_season:"Season: ",life_stage:"Life stage: ",
       greg_age:"Age (Gregorian)",hijri_age:"Age (Hijri – Umm al-Qura)",
       facts:"Facts from your life",clarify:"Approximate averages: 20k breaths/day, 80 bpm, 10 laughs/day, 8 h sleep/day, 80 min eating/day.",
       timezone:"Time Zone",cd_days:"Days",cd_hours:"Hours",cd_minutes:"Minutes",cd_seconds:"Seconds",
       countdown_title:"Countdown to your next birthday",birthday_today:"It's your birthday today! Happy Birthday 🎉"}
};
function getLang(){return localStorage.getItem('ageLang')||'ar'}
function setLang(L){localStorage.setItem('ageLang',L); location.reload();}
function applyI18n(){
  const L=getLang();
  document.querySelectorAll('[data-i18n]').forEach(el=>{ const k=el.getAttribute('data-i18n'); if(TEXTS[L]&&TEXTS[L][k]) el.textContent = TEXTS[L][k]; if(L==='en') el.classList.add('ltr'); else el.classList.remove('ltr'); });
  document.body.setAttribute('lang', L);
  document.body.setAttribute('dir', 'rtl');
}
function setTheme(t){ localStorage.setItem('ageTheme',t); if(t==='dark'){document.documentElement.removeAttribute('data-theme');} else {document.documentElement.dataset.theme=t;} }
function setAccent(p){ const a=p.split(','); localStorage.setItem('ageAccent',p); document.documentElement.style.setProperty('--accent',a[0]); document.documentElement.style.setProperty('--accent-2',a[1]||a[0]); }
function setupSettings(){
  const t=localStorage.getItem('ageTheme')||'dark'; setTheme(t);
  ['th-light','th-dark','th-amoled'].forEach(id=>{const el=document.getElementById(id); if(!el) return; const v=el.dataset.theme; el.classList.toggle('selected', (t===v || (t==='dark' && v==='dark'))); el.onclick=()=>{ setTheme(v); document.querySelectorAll('.tag[data-theme]').forEach(x=>x.classList.remove('selected')); el.classList.add('selected'); };});
  const acc=localStorage.getItem('ageAccent')||'#6d5cff,#22d3ee'; setAccent(acc);
  document.querySelectorAll('#colorRow .tag').forEach(dot=>{ dot.onclick=()=>{ setAccent(dot.dataset.accent); }; });
  const L=getLang(); document.querySelectorAll('.row .tag[data-lang]').forEach(ch=>{ ch.classList.toggle('selected', ch.dataset.lang===L); ch.onclick=()=> setLang(ch.dataset.lang); });
  const zones=['Asia/Riyadh','Asia/Kuwait','Asia/Dubai','Asia/Qatar','Asia/Bahrain','Asia/Muscat','Africa/Cairo','Europe/Istanbul','Europe/London','Europe/Paris','America/Los_Angeles','America/New_York','Asia/Karachi','Asia/Dhaka','Asia/Tokyo'];
  const AR={'Asia/Riyadh':'الرياض (السعودية)','Asia/Kuwait':'الكويت','Asia/Dubai':'دبي (الإمارات)','Asia/Qatar':'الدوحة (قطر)','Asia/Bahrain':'المنامة (البحرين)','Asia/Muscat':'مسقط (عُمان)','Africa/Cairo':'القاهرة (مصر)','Europe/Istanbul':'إسطنبول (تركيا)','Europe/London':'لندن (المملكة المتحدة)','Europe/Paris':'باريس (فرنسا)','America/Los_Angeles':'لوس أنجلِس (أمريكا)','America/New_York':'نيويورك (أمريكا)','Asia/Karachi':'كراتشي (باكستان)','Asia/Dhaka':'دكا (بنغلاديش)','Asia/Tokyo':'طوكيو (اليابان)'};
  const EN={'Asia/Riyadh':'Riyadh (KSA)','Asia/Kuwait':'Kuwait','Asia/Dubai':'Dubai (UAE)','Asia/Qatar':'Doha (Qatar)','Asia/Bahrain':'Manama (Bahrain)','Asia/Muscat':'Muscat (Oman)','Africa/Cairo':'Cairo (Egypt)','Europe/Istanbul':'Istanbul (Türkiye)','Europe/London':'London (UK)','Europe/Paris':'Paris (France)','America/Los_Angeles':'Los Angeles (USA)','America/New_York':'New York (USA)','Asia/Karachi':'Karachi (Pakistan)','Asia/Dhaka':'Dhaka (Bangladesh)','Asia/Tokyo':'Tokyo (Japan)'};
  const sel=document.getElementById('tzSelect'); sel.innerHTML=''; (getLang()==='ar'?Object.entries(AR):Object.entries(EN)).forEach(([v,txt])=>{ const o=document.createElement('option'); o.value=v; o.textContent=txt; sel.appendChild(o); });
  sel.value = localStorage.getItem('ageTZ')||'Asia/Riyadh';
  sel.onchange = ()=>{ localStorage.setItem('ageTZ', sel.value); location.reload(); };
}
function nowInTZ(tz){ return new Date(new Date().toLocaleString('en-US',{timeZone:tz})); }
function fmt(n,lang){ try{return n.toLocaleString(lang==='ar'?'ar-EG':'en-US');}catch(e){return ''+n;} }
function weekdayName(date,lang){ const ar=['الأحد','الإثنين','الثلاثاء','الأربعاء','الخميس','الجمعة','السبت']; const en=['Sun','Mon','Tue','Wed','Thu','Fri','Sat']; return (lang==='ar'?ar:en)[date.getDay()]; }
function seasonName(m,lang){ const ar={winter:'الشتاء',spring:'الربيع',summer:'الصيف',autumn:'الخريف'}; const en={winter:'Winter',spring:'Spring',summer:'Summer',autumn:'Autumn'}; const s=[12,1,2].includes(m)?'winter':[3,4,5].includes(m)?'spring':[6,7,8].includes(m)?'summer':'autumn'; return (lang==='ar'?ar:en)[s]; }
function lifeStage(y,lang){ if(lang==='en'){ if(y<13)return'Childhood'; if(y<20)return'Adolescence'; if(y<36)return'Young adult'; if(y<60)return'Middle age'; return'Senior'; } else { if(y<13)return'طفولة'; if(y<20)return'مراهقة'; if(y<36)return'شباب'; if(y<60)return'متوسط العمر'; return'كبير سن'; } }
function islamicToJD(y,m,d){ return d + Math.ceil(29.5*(m-1)) + (y-1)*354 + Math.floor((3+11*y)/30) + 1948439.5; }
function jdToGregorian(jd){ const j=Math.floor(jd+0.5); const f=j+1401+Math.floor((Math.floor((4*j+274277)/146097)*3)/4)-38; const e=4*f+3; const g=Math.floor((e%1461)/4); const h=5*g+2; const D=Math.floor((h%153)/5)+1; const M=((Math.floor(h/153)+2)%12)+1; const Y=Math.floor(e/1461)-4716+Math.floor((12+2-M)/12); return {year:Y,month:M,day:D}; }
function gregorianToJD(y,m,d){ if(m<=2){y-=1;m+=12;} const A=Math.floor(y/100); const B=2-A+Math.floor(A/4); return Math.floor(365.25*(y+4716))+Math.floor(30.6001*(m+1))+d+B-1524.5; }
function jdToIslamic(jd){ const jd2=Math.floor(jd)+0.5; const days=jd2-1948439.5; let y=Math.floor((30*days+10646)/10631); let m=Math.min(12, Math.ceil((days-(29+islamicToJD(y,1,1)-1948439.5))/29.5)+1); let d=Math.floor(jd2-islamicToJD(y,m,1))+1; if(d<=0){ m-=1; if(m<1){ m=12; y-=1; } d=Math.floor(jd2-islamicToJD(y,m,1))+1; } return {year:y,month:m,day:d}; }
function hijriToGreg(y,m,d){ return jdToGregorian(islamicToJD(y,m,d)); }
function gregToHijri(dt){ const jd=gregorianToJD(dt.getFullYear(), dt.getMonth()+1, dt.getDate()); return jdToIslamic(jd); }
const SITE_DOMAIN="age.majeedpng.online", NAME_AR="عبدالمجيد الثويني", NAME_EN="Abdulmajeed Althuwaini";
let cdTimer=null;
function startCountdown(target, tz, lang){ if(cdTimer) clearInterval(cdTimer); const upd=()=>{ const now=new Date(); let diff=target-now; if(diff<0) diff=0; const s=Math.floor(diff/1000); const d=Math.floor(s/86400); const h=Math.floor((s%86400)/3600); const m=Math.floor((s%3600)/60); const sec=s%60;
  document.getElementById('cdDays').textContent=d; document.getElementById('cdHours').textContent=h; document.getElementById('cdMin').textContent=m; document.getElementById('cdSec').textContent=sec; }; upd(); cdTimer=setInterval(upd,1000);}
function enforceLTRDynamic(){ const L=getLang(); const ids=['gregInfo','hijriInfo','sleepTag','sleepHint']; ids.forEach(id=>{ const el=document.getElementById(id); if(!el) return; if(L==='en') el.classList.add('ltr'); else el.classList.remove('ltr'); }); }
function toYMD(dd){ const y=Math.floor(dd/365.25); dd-=y*365.25; const mo=Math.floor(dd/30.4375); dd-=mo*30.4375; const d=Math.round(dd); return {y,mo,d}; }
function calcAndRender(){
  const lang=getLang(); const tz=localStorage.getItem('ageTZ')||'Asia/Riyadh';
  // seed example if none
  if(!localStorage.getItem('birthInfo')){ localStorage.setItem('birthInfo', JSON.stringify({type:'greg', greg:{gD:2,gM:2,gY:1999}})); }
  const b=JSON.parse(localStorage.getItem('birthInfo'));
  let gY, gM, gD;
  if(b.type==='hijri'){ const g=hijriToGreg(b.hijri.hY,b.hijri.hM,b.hijri.hD); gY=g.year; gM=g.month; gD=g.day; }
  else { gY=b.greg.gY; gM=b.greg.gM; gD=b.greg.gD; }
  const birth=new Date(gY,gM-1,gD); const nowTZ=new Date();
  const ageMs=nowTZ-birth; const dayMs=86400000; const days=Math.floor(ageMs/dayMs); const hours=Math.floor(ageMs/3600000);
  const years=(nowTZ.getFullYear()-gY)-(((nowTZ.getMonth()+1)<gM)||((nowTZ.getMonth()+1===gM)&&(nowTZ.getDate()<gD))?1:0);
  let months=years*12+(nowTZ.getMonth()+1)-gM; if(nowTZ.getDate()<gD) months-=1; const weeks=Math.floor(days/7);
  const birthH=gregToHijri(new Date(gY,gM-1,gD)); const nowH=gregToHijri(nowTZ);
  let hy=nowH.year-birthH.year, hm=nowH.month-birthH.month, hd=nowH.day-birthH.day; if(hd<0){hd+=30;hm-=1;} if(hm<0){hm+=12;hy-=1;}
  const useHijri=(b.type==='hijri'); const yearsTop=useHijri?hy:years; const monthsTop=useHijri?(hy*12+hm):months;
  document.getElementById('yearsAge').textContent=yearsTop; document.getElementById('monthsAge').textContent=monthsTop; document.getElementById('weeksAge').textContent=weeks; document.getElementById('daysAge').textContent=days; document.getElementById('hoursAge').textContent=hours;
  // info
  document.getElementById('gregInfo').innerHTML=(lang==='ar'?'تاريخ الميلاد: <b>'+gD+'-'+gM+'-'+gY+'</b>':'Birthdate: <b>'+gD+'-'+gM+'-'+gY+'</b>');
  document.getElementById('hijriInfo').innerHTML=(lang==='ar'?'تاريخ الميلاد: <b>'+birthH.day+'-'+birthH.month+'-'+birthH.year+' هـ</b>':'Birth (Hijri): <b>'+birthH.day+'-'+birthH.month+'-'+birthH.year+' AH</b>');
  // banners
  const today=new Date(); if(today.getDate()===gD && (today.getMonth()+1)===gM) document.body.classList.add('birthday');
  // sleep healthy
  function sleepRange(ageY){ if(ageY<0.25) return [14,17]; if(ageY<1) return [12,15]; if(ageY<3) return [11,14]; if(ageY<6) return [10,13]; if(ageY<14) return [9,11]; if(ageY<18) return [8,10]; if(ageY<65) return [7,9]; return [7,8]; }
  const sr=sleepRange(years);
  const sTag=document.getElementById('sleepTag'); const sHint=document.getElementById('sleepHint');
  if(lang==='ar'){ sTag.textContent='نومك الصحي: من '+sr[0]+' إلى '+sr[1]+' ساعات'; sHint.textContent='قيمة تقديرية ثابتة حسب العمر (إرشادات عامة).'; } else { sTag.textContent='Healthy sleep: from '+sr[0]+' to '+sr[1]+' hours'; sHint.textContent='Approximate age-based range (general guidelines).'; } sHint.style.display='block';
  // facts
  const breaths=20000*days; const bpm=80; const heartbeats=Math.round(bpm*60*24*days); const laughs=10*days;
  const s=toYMD((8/24)*days); const e=toYMD((80/60/24)*days);
  document.getElementById('breathsLine').textContent=(lang==='ar'?'تَنَفَّستَ حوالي ':'You breathed about ')+breaths.toLocaleString(lang==='ar'?'ar-EG':'en-US')+(lang==='ar'?' مرة':' times');
  document.getElementById('heartbeatsLine').textContent=(lang==='ar'?'نَبَضَ قلبك حوالي ':'Your heart beat about ')+heartbeats.toLocaleString(lang==='ar'?'ar-EG':'en-US')+(lang==='ar'?' نبضة':' times');
  document.getElementById('laughsLine').textContent=(lang==='ar'?'ضَحِكتَ حوالي ':'You laughed about ')+laughs.toLocaleString(lang==='ar'?'ar-EG':'en-US')+(lang==='ar'?' مرة':' times');
  document.getElementById('sleptLine').textContent=(lang==='ar'?'نِمتَ حوالي ':'You slept about ')+s.y+(lang==='ar'?' سنة و ':' years, ')+s.mo+(lang==='ar'?' شهر و ':' months, and ')+s.d+(lang==='ar'?' يوم':' days');
  document.getElementById('eatenLine').textContent=(lang==='ar'?'أمضيت في تناول الطعام ':'You ate ')+e.y+(lang==='ar'?' سنة و ':' years, ')+e.mo+(lang==='ar'?' شهر و ':' months, and ')+e.d+(lang==='ar'?' يوم':' days');
  // countdown target
  const next=new Date(nowTZ.getFullYear() + ((nowTZ.getMonth()+1>gM || ((nowTZ.getMonth()+1===gM)&& nowTZ.getDate()>gD))?1:0), gM-1, gD);
  startCountdown(next, tz, lang);
  document.getElementById('contentArea').style.display='grid'; enforceLTRDynamic();
}
document.getElementById('openCustomize').onclick=()=>{ const p=document.getElementById('settings'); p.style.display = (p.style.display==='none'?'block':'none'); };
applyI18n(); setupSettings(); enforceLTRDynamic(); calcAndRender();
</script>
</body>
</html>

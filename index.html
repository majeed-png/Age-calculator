<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>حاسبة العمر – إدخال التاريخ | عبدالمجيد الثويني</title>
<meta name="description" content="حاسبة العمر العربية: احسب عمرك بالميلادي أو بالهجري بسرعة وبدقة. يعمل دون إنترنت.">
<meta name="keywords" content="حاسبة العمر, حساب العمر, احسب عمرك, حساب العمر بالميلادي, حساب العمر بالهجري, تحويل التاريخ, العمر بالاشهر, كم عمري, كم باقي على عيد ميلادي, تقييم العمر, Age Calculator Arabic, Hijri to Gregorian, Gregorian to Hijri, حساب تاريخ الميلاد, حساب العمر الحقيقي, أم القرى">
<meta property="og:title" content="حاسبة العمر – إدخال التاريخ">
<meta property="og:description" content="احسب عمرك بالميلادي أو بالهجري (أم القرى) بسرعة وبدقة.">
<style>
:root{
  --bg:#0f1115;
  --card:#151a22;
  --text:#e9eef6;
  --muted:#a8b3c7;
  --accent:#6d62ff; /* default accent */
  --accent-2:#6d62ff;
  --radius:14px;
  --shadow: 0 10px 30px rgba(0,0,0,.25);
  --font: "Tajawal", system-ui, -apple-system, "Segoe UI", Roboto, "Noto Kufi Arabic", "Noto Sans Arabic", Arial, "Apple Color Emoji","Segoe UI Emoji";
}
/* LIGHT THEME */
:root[data-theme='light']{
  --bg:#f5f7fb;
  --card:#ffffff;
  --text:#0b0f14;
  --muted:#536175;
}
/* AMOLED true black */
:root[data-theme='amoled']{
  --bg:#000000;
  --card:#0a0a0a;
  --text:#e9eef6;
  --muted:#a8b3c7;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:
     radial-gradient(1200px 600px at 100% -10%, rgba(124,92,255,.10), transparent 60%),
     radial-gradient(1200px 600px at -30% 110%, rgba(46,211,198,.08), transparent 60%),
     var(--bg);
  color:var(--text);
  font-family:var(--font);
  line-height:1.7;
}
:root[data-theme='light'] body,
:root[data-theme='light']{
  background:
     radial-gradient(1200px 600px at 100% -10%, rgba(124,92,255,.08), transparent 60%),
     radial-gradient(1200px 600px at -30% 110%, rgba(46,211,198,.08), transparent 60%),
     var(--bg);
}
.container{max-width:1000px;margin:24px auto;padding:16px}
.card{
  background:var(--card);
  border:1px solid rgba(255,255,255,.06);
  border-radius: var(--radius);
  padding:18px;
  box-shadow: var(--shadow);
  margin-top:16px;
}
:root[data-theme='light'] .card{border:1px solid rgba(10,10,10,.06)}
h1{margin:0 0 8px 0;font-weight:800;letter-spacing:.2px}
h2{margin:22px 0 10px 0;font-weight:800}
h3{margin:14px 0 10px 0;font-weight:800}
a{color:var(--accent)}
label{display:block;font-weight:700;margin-bottom:6px}
input, select, button{
  width:100%;
  border-radius:12px;
  padding:12px 14px;
  height:52px;
  background:#0c0f14;
  color:var(--text);
  border:1px solid rgba(255,255,255,.08);
  outline:none;
  transition: box-shadow .2s, border-color .2s;
}
:root[data-theme='light'] input,
:root[data-theme='light'] select,
:root[data-theme='light'] button{
  background:#f1f5f9;
  border:1px solid rgba(0,0,0,.08);
  color:#0b0f14;
}
input:focus, select:focus{
  box-shadow:0 0 0 3px color-mix(in oklab, var(--accent) 40%, transparent);
  border-color: var(--accent);
}
button{
  cursor:pointer;
  border:none;
  background:linear-gradient(135deg, var(--accent), var(--accent-2));
  color:white;
  font-weight:800;
}
.muted{color:var(--muted)}
.notice{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:14px;margin-top:10px}
:root[data-theme='light'] .notice{background:#f8fafc;border:1px dashed rgba(0,0,0,.12)}
.navbar{
  display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:8px
}
.navbar .row{display:flex;gap:10px;flex-wrap:nowrap}
.badge{
  display:inline-flex;gap:8px;align-items:center;
  padding:6px 10px;border-radius:999px;
  background:rgba(255,255,255,.06);font-weight:700
}
.inputs{display:grid;grid-template-columns:1fr 1fr;gap:12px;align-items:end}
@media(max-width:800px){.inputs{grid-template-columns:1fr}}
.kpis{display:grid;grid-template-columns:repeat(5,1fr);gap:12px}
@media(max-width:900px){.kpis{grid-template-columns:repeat(2,1fr)}}
.kpi{background:#0c0f14;border:1px solid rgba(255,255,255,.06);border-radius:12px;padding:14px}
:root[data-theme='light'] .kpi{background:#f1f5f9;border:1px solid rgba(0,0,0,.06)}
.kpi .num{font-size:1.6rem;font-weight:900}
.tag{padding:6px 10px;border-radius:12px;background:rgba(255,255,255,.08);font-weight:700}
:root[data-theme='light'] .tag{background:#eef2f7}
footer{opacity:.7;padding:20px 6px}
.panel{display:none;margin-top:10px}
.row{display:flex;gap:10px;flex-wrap:wrap}
.theme-btn{
  padding:12px 14px;border-radius:12px;background:#0c0f14;border:1px solid rgba(255,255,255,.14);
  cursor:pointer;color:var(--text)!important;min-width:140px;text-align:center;position:relative;
}
:root[data-theme='light'] .theme-btn{background:#f1f5f9;border:1px solid rgba(0,0,0,.12);color:#0b0f14!important}
.theme-btn.selected{outline:3px solid var(--accent); outline-offset:3px; border-color:var(--accent)}
.color-dot{width:26px;height:26px;border-radius:50%;border:2px solid rgba(255,255,255,.5);cursor:pointer;position:relative}
:root[data-theme='light'] .color-dot{border-color:rgba(0,0,0,.35)}
.color-dot.selected::after{
  content:"✓"; position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
  font-weight:900; color:#000; mix-blend-mode:screen;
}
.small-btn{min-width:56px}
/* Custom select wrapper for consistent height */
.select-wrap{position:relative}
.select-wrap select{appearance:none;-webkit-appearance:none;padding-inline-start:14px;padding-inline-end:40px}
.select-wrap .caret{
  position:absolute; left:12px; top:50%; transform:translateY(-50%); pointer-events:none; opacity:.7;
}

.inputs{grid-template-columns:repeat(4,1fr)}
@media(max-width:800px){.inputs{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="container">
  <div class="navbar">
    <div class="badge">⚡ آلة حساب العمر</div>
    <div class="row">
      <button id="openCustomize" style="max-width:160px">الإعدادات</button>
    </div>
  </div>

  <div class="card">
    <h1>أدخل تاريخ ميلادك</h1>
    <div class="muted">اختر نوع التاريخ، ثم اكتب اليوم والشهر والسنة.</div>
    <div class="notice" style="margin-top:10px">التحويل <b>الهجري</b> هنا وفق <b>تقويم أم القرى</b> للفترة 1937–2077 (قد يختلف قبل/بعد هذا النطاق).</div>
    <div class="inputs" style="margin-top:10px">
      <div class="select-wrap">
        <label>نوع التاريخ</label>
        <select id="calType">
          <option value="greg" selected>ميلادي</option>
          <option value="hijri">هجري (أم القرى)</option>
        </select>
        <div class="caret">▾</div>
      </div>
      <div>
        <label>اليوم</label>
        <input id="day" type="number" min="1" max="31" placeholder="1">
      </div>
      <div>
        <label>الشهر</label>
        <input id="month" type="number" min="1" max="12" placeholder="1">
      </div>
      <div>
        <label>السنة</label>
        <input id="year" type="number" min="1" max="9999" placeholder="1410 أو 1998">
      </div>
    </div>
    <div class="row" style="margin-top:12px">
      <button id="calcBtn" style="max-width:200px">احسب</button>
    </div>
  </div>

  
<div id="customizePanel" class="panel notice">
  <h3>الخلفية</h3>
  <div class="row">
    <div class="theme-btn" data-theme="light">فاتح</div>
    <div class="theme-btn" data-theme="dark">داكن</div>
    <div class="theme-btn" data-theme="amoled">أسود خالص (AMOLED)</div>
  </div>
  <hr/>
  <h3>لون الأزرار</h3>
  <div class="row" id="accentRow">
    <div class="color-dot" data-accent="#6d62ff" style="background:#6d62ff"></div>
    <div class="color-dot" data-accent="#2ed3c6" style="background:#2ed3c6"></div>
    <div class="color-dot" data-accent="#f97316" style="background:#f97316"></div>
    <div class="color-dot" data-accent="#22c55e" style="background:#22c55e"></div>
    <div class="color-dot" data-accent="#06b6d4" style="background:#06b6d4"></div>
    <div class="color-dot" data-accent="#ef4444" style="background:#ef4444"></div>
  </div>
  <div class="muted" style="margin-top:8px">الخلفية لا تغيّر ألوان الأزرار — اختر اللون هنا.</div>
</div>


  <footer class="container">
    صُنِع لـ <b>عبدالمجيد الثويني</b> · يعمل دون إنترنت · © <span id="yearNow"></span>
  </footer>
</div>

<script>
const $ = (id)=>document.getElementById(id);
const fmt = (n)=> Number.isFinite(n) ? n.toLocaleString('ar-SA') : '—';

function markSelectedTheme(t){
  document.querySelectorAll('.theme-btn').forEach(b=>{
    if(b.getAttribute('data-theme')===t) b.classList.add('selected');
    else b.classList.remove('selected');
  });
}
function markSelectedAccent(c){
  document.querySelectorAll('.color-dot').forEach(d=>{
    if(d.getAttribute('data-accent')===c) d.classList.add('selected');
    else d.classList.remove('selected');
  });
}
function setTheme(t){
  if(!t) t='dark';
  const root = document.documentElement;
  if(t==='light') root.setAttribute('data-theme','light');
  else if(t==='amoled') root.setAttribute('data-theme','amoled');
  else { root.setAttribute('data-theme','dark'); t='dark'; }
  localStorage.setItem('ageTheme', t);
  markSelectedTheme(t);
}
function setAccent(c){
  document.documentElement.style.setProperty('--accent', c);
  document.documentElement.style.setProperty('--accent-2', c);
  localStorage.setItem('ageAccent', c);
  markSelectedAccent(c);
}
function loadPrefs(){
  const t = localStorage.getItem('ageTheme') || 'dark';
  const c = localStorage.getItem('ageAccent') || '#6d62ff';
  setAccent(c);
  setTheme(t);
}
function setupSettings(){
  const btn = document.getElementById('openCustomize');
  const p = document.getElementById('customizePanel');
  if(btn && p){ btn.onclick = ()=>{ p.style.display = (p.style.display === 'block') ? 'none' : 'block'; }; }
  document.querySelectorAll('.theme-btn').forEach(b=> b.addEventListener('click', ()=> setTheme(b.getAttribute('data-theme')) ));
  document.querySelectorAll('.color-dot').forEach(d=> d.addEventListener('click', ()=> setAccent(d.getAttribute('data-accent')) ));
  loadPrefs();
}

// ===== Calendars (Tabular + Umm al-Qura via Intl) =====
function gregToJDN(y,m,d){
  if(m <= 2){ y -= 1; m += 12; }
  const A = Math.floor(y/100);
  const B = 2 - A + Math.floor(A/4);
  return Math.floor(365.25*(y + 4716)) + Math.floor(30.6001*(m + 1)) + d + B - 1524.5;
}
function jdnToGreg(jd){
  const Z = Math.floor(jd + 0.5);
  let A = Z;
  const alpha = Math.floor((A - 1867216.25)/36524.25);
  A = A + 1 + alpha - Math.floor(alpha/4);
  const B = A + 1524;
  const C = Math.floor((B - 122.1)/365.25);
  const D = Math.floor(365.25*C);
  const E = Math.floor((B - D)/30.6001);
  const day = B - D - Math.floor(30.6001*E);
  const month = (E < 14) ? E - 1 : E - 13;
  const year = (month > 2) ? C - 4716 : C - 4715;
  return {year, month, day};
}
// Tabular islamic -> JDN
const ISLAMIC_EPOCH = 1948439.5;
function islamicToJDN(y,m,d){
  return d + Math.ceil(29.5*(m-1)) + (y-1)*354 + Math.floor((3 + 11*y)/30) + ISLAMIC_EPOCH - 1;
}

// Use Intl to get Umm al-Qura y/m/d for a Gregorian date (returns numbers)
function gregToUmmAlQura(date){
  const parts = new Intl.DateTimeFormat('en-u-ca-islamic-umalqura', {year:'numeric',month:'numeric',day:'numeric'}).formatToParts(date);
  return {
    year: +parts.find(p=>p.type==='year').value,
    month:+parts.find(p=>p.type==='month').value,
    day:  +parts.find(p=>p.type==='day').value
  };
}
// Find Gregorian date that corresponds to given Umm al-Qura y/m/d using local search around tabular estimate
function ummAlQuraToGreg(y,m,d){
  // initial guess via tabular
  const g0 = jdnToGreg(islamicToJDN(y,m,d));
  const base = new Date(Date.UTC(g0.year, g0.month-1, g0.day));
  const dayMs = 24*60*60*1000;
  const tryFind = (span)=>{
    for(let off=-span; off<=span; off++){
      const t = new Date(base.getTime()+ off*dayMs);
      const h = gregToUmmAlQura(t);
      if(h.year===y && h.month===m && h.day===d){
        return {year:t.getUTCFullYear(), month:t.getUTCMonth()+1, day:t.getUTCDate()};
      }
    }
    return null;
  };
  return tryFind(6) || tryFind(20) || {year:g0.year, month:g0.month, day:g0.day}; // fallback tabular
}
// Hijri month length (Umm al-Qura) by difference between 1st of next and current month
function ummMonthLength(y,m){
  const start = ummAlQuraToGreg(y,m,1);
  let ny = y, nm = m+1; if(nm>12){ nm=1; ny++; }
  const next = ummAlQuraToGreg(ny,nm,1);
  const d1 = Date.UTC(start.year, start.month-1, start.day);
  const d2 = Date.UTC(next.year, next.month-1, next.day);
  return Math.round((d2-d1)/(24*60*60*1000));
}


document.getElementById('calcBtn').onclick = ()=>{ 
  const d = +$('day').value, m = +$('month').value, y = +$('year').value;
  if(!d||!m||!y){alert('من فضلك أكمل اليوم والشهر والسنة'); return;}
  const type = $('calType').value;
  let gY,gM,gD;
  if(type==='greg'){ gY=y; gM=m; gD=d; }
  else {
    const g = ummAlQuraToGreg(y,m,d); // precise by Intl
    gY=g.year; gM=g.month; gD=g.day;
  }
  localStorage.setItem('birthInfo', JSON.stringify({type, input:{d,m,y}, greg:{gY,gM,gD}}));
  window.location.href = 'age-details.html';
};
['day','month','year'].forEach(id=> $(id).addEventListener('keydown', e=>{ if(e.key==='Enter') $('calcBtn').click(); }));

document.getElementById('yearNow').textContent = new Date().getFullYear();
setupSettings();
</script>
</body>
</html>
